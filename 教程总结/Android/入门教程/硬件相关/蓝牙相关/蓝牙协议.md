www.ellisys.com  ellisys分析bluetooth,usb，WiFi等协议

https://www.bluetooth.com/zh-cn/
低功耗学习指南：https://www.bluetooth.com/zh-cn/bluetooth-resources/le-security-study-guide/
  V1.1pdf90页
核心规范：https://www.bluetooth.com/specifications/bluetooth-core-specification/
  例如蓝牙5.0 https://www.bluetooth.com/zh-cn/specifications/specs/core-specification-5-0/
  pdf有2822页
服务uuid定义：https://www.bluetooth.com/specifications/assigned-numbers/#assignedNumbers


PHY相关
https://www.bluetooth.com/bluetooth-resources/intro-to-bluetooth-low-energy-coded-phy/
application layer
link layer
physical layer  (phy)
bluetooth radio
phy有三种取值
1M  从蓝牙4.0开始 2010
2M  从蓝牙5.0开始，速率是1M的2倍
coded 从蓝牙5.0开始
  可选 s=2 500kps  s=8 125kps
  增加电量消耗
  对long-range,可靠性连接的设备有帮助，穿透墙和障碍物的能力更强
coded phy 0dbm tx: 1300 meters
coded phy +5dbm tx: 1500 meters
android中配置
```
adapter.isLe2MPhySupported()
gatt.readPhy()  回调onPhyRead
gatt.setPreferredPhy(BluetoothDevice.PHY_LE_2M,BluetoothDevice.PHY_LE_2M,BluetoothDevice.PHY_OPTION_NO_PREFERRED)
  回调onPhyUpdate
```

https://www.jianshu.com/p/743dd0b4266c
mtu
MTU是什么？
MTU是指在一个协议数据单元中（Protocol Data Unit, PDU) 有效的最大传输Byte。

MTU默认是23byte,但是供我们使用的只有20byte。所以有时候不能满足我们的需求，需要我们手动设置MTU的大小。
core spec中ATT的默认MTU为23个Byte，ATT的Opcode占1个Byte、ATT的Handle占2个Byte、GATT占20个Byte。
23Byte(ATT)=1Byte(Opcode)+2Byte(Handler)+20Byte(BATT)
蓝牙4.0，max mtu据说为256
蓝牙5.0后，max mtu为512
android设置mtu
```
//蓝牙连接后
BluetoothGatt#requestMtu（int MTU）
onMtuChanged(BluetoothGatt gatt, int mtu, int status)
```

接受信号强度Received Signal Strength Indicator
可用于定位
```
gatt.readRemoteRssi
```
https://blog.csdn.net/chy555chy/article/details/82460151
一般为负值，反应的是信号的衰减程度，理想状态下（无衰减），Rssi = 0dBm，实际情况是，即使蓝牙设备挨得非常近，Rssi也只有-50dBm的强度，在传输过程中，不可避免要损耗。
一般情况下，经典蓝牙强度
-50 ~ 0dBm 信号强
-70 ~-50dBm 信号中
<-70dBm 信号弱
低功耗蓝牙分四级
-60 ~ 0 4
-70 ~ -60 3
-80 ~ -70 2
<-80 1