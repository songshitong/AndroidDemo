
https://mp.weixin.qq.com/s/XE9Ef27Zj2tU9KnNAbDl9Q
计时不准确
https://juejin.cn/post/6859335893447901198
https://blog.csdn.net/qq_31796651/article/details/104691078

锁屏导致计时不准确
timer+锁屏计时修正   锁屏开屏计算时间段
更推荐使用生命周期计算，包括了锁屏(限制活动)，后台(限制电量)的场景，都会触发生命周期
```
private int serous = 0;
  //锁屏时秒数
  private int lockSerous =0;
  private BroadcastReceiver  receiver = new BroadcastReceiver() {
    //锁屏计时
    private long screenOffTime;
    @Override
    public void onReceive(Context context, Intent intent) {
      if (Objects.equals(intent.getAction(), Intent.ACTION_SCREEN_OFF)) {
        Logger.i("收到锁屏广播");
        //记录锁屏的秒数
        lockSerous = serous;
        screenOffTime = System.currentTimeMillis();
      } else if (Objects.equals(intent.getAction(), Intent.ACTION_SCREEN_ON)) {
        Logger.i("屏幕亮起广播");
         if (screenOffTime == 0) {//没收到锁屏广播
          return;
        }
        //锁屏这段时间时长 秒
        int diffTime = (int) ((System.currentTimeMillis() - screenOffTime) / 1000);
        //应该的秒数
        int computeTime = diffTime+lockSerous;
        Logger.i("AHStartAudioView "+"computeTime "+computeTime+" serous "+serous);
        if(computeTime> serous){
          serous = computeTime;
        }
        screenOffTime = 0;
      }
    }
  };

//开启广播  不用权限
 private void initReceiver() {
    IntentFilter filter = new IntentFilter();
    filter.addAction(Intent.ACTION_SCREEN_OFF);
    filter.addAction(Intent.ACTION_SCREEN_ON);
    mContext.registerReceiver(receiver, filter);
  }  
 private void destroyReceiver(){
    mContext.unregisterReceiver(receiver);
 }
  
 Timer timer = new Timer();
  TimerTask timerTask = new TimerTask() {
    public void run() {
      serous++;
      //每隔一秒会执行一次
      updateTime();
    }
  }; 
  
    //结束计时
  private void stopTimer(){
    timer.cancel();
  }

  //开始计时
  private void startTimer(){
    timer.schedule(timerTask,0,1000);
  }
 
```

CountDownTimer计时，倒计时15秒，1秒一次
```
 CountDownTimer timer = new CountDownTimer(15*1000,1000) {
    @Override public void onTick(long millisUntilFinished) {

    }

    @Override public void onFinish() {

    }
  };
```



