

https://chatgpt.com/c/9c1afec3-9228-4bb2-b871-906d3634850b
负载均衡（Load Balancing）
负载均衡是一种技术，用于将网络流量分配到多个服务器或资源，以优化资源使用、最大化吞吐量、减少响应时间并避免单个服务器过载。
负载均衡器（Load Balancer）可以是硬件设备，也可以是软件程序。
主要功能：
流量分配：根据预设算法（如轮询法、最少连接法、IP哈希等）将流量分配到不同的服务器。
故障切换：当某个服务器不可用时，自动将流量重新分配到其他可用的服务器。
健康检查：定期探测后端服务器的健康状态，以确保流量仅被分配到正常运行的服务器。

七层负载均衡（应用层负载均衡）
七层负载均衡工作在OSI模型的第七层，即应用层。应用层是最靠近用户的层，负责应用程序和网络服务之间的直接交互
四层负载均衡（传输层负载均衡）
四层负载均衡工作在OSI模型的第四层，即传输层。传输层负责主机到主机之间的数据传输，常见的协议包括TCP和UDP

常见的流量分配算法：
1 轮询法（Round Robin）
轮询法是最简单且常用的算法之一，它按顺序将请求依次分配给后端服务器。每个服务器依次接收请求，然后循环回到第一个服务器
优点：
简单易实现。
适用于后端服务器性能相同的场景。
缺点：
不考虑服务器的当前负载和性能差异，可能导致某些服务器过载。

2 加权轮询法（Weighted Round Robin）
加权轮询法是轮询法的扩展，每个服务器分配一个权重，根据权重值分配请求。权重高的服务器接收更多的请求。
优点：
适用于后端服务器性能不同的场景。
可以根据服务器处理能力进行合理分配。
缺点：
权重需要手动配置和调整。
对负载动态变化的处理不够灵活。

3 最少连接法（Least Connections）
最少连接法将新请求分配给当前活动连接数最少的服务器。这种方法动态地考虑了服务器的负载情况。
优点：
实时反映服务器的负载情况。
适用于长连接的应用场景，如数据库连接。
缺点：
需要不断跟踪和统计每个服务器的活动连接数。
在短连接场景下可能不如预期有效。

4 加权最少连接法（Weighted Least Connections）
加权最少连接法结合了加权和最少连接法，给每个服务器分配权重，考虑权重和当前连接数，选择负载最轻的服务器。
优点：
结合了加权轮询法和最少连接法的优点。
更加灵活，适用于性能不均的服务器集群。
缺点：
实现复杂度较高。
权重配置和动态负载统计要求较高。

5
IP哈希法（IP Hash）
IP哈希法根据客户端的IP地址进行哈希运算，得到一个服务器的索引，将请求分配给特定的服务器。这种方法能确保来自同一IP地址的请求始终分配到同一台服务器
优点：
适用于需要会话保持的场景，如状态会话应用。
确保来自同一IP地址的请求一致性。
缺点：
负载分配不均衡的风险，特别是在IP分布不均匀时。
缺乏灵活性，无法动态调整负载。

6
随机法（Random）
随机法是将请求随机分配给后端服务器，每次请求都随机选择一台服务器。
优点：
简单易实现。
适用于不需要考虑负载均衡和服务器性能差异的场景。
缺点：
无法保证负载均衡，可能导致某些服务器过载。
对动态负载变化处理不佳

7
最快响应时间法（Fastest Response Time）
最快响应时间法根据服务器的响应时间分配请求，选择响应时间最快的服务器。
优点：
动态反映服务器的实际性能和负载。
能优化用户体验，减少请求延迟。
缺点：
实现复杂度较高。
需要实时监控和统计服务器的响应时间



源站探测（Origin Server Health Check）
源站探测，或称健康检查，是指负载均衡器或其他网络设备定期检查后端服务器（源站）的健康状态，确保这些服务器能够正常响应请求。
主要功能：
定期检查：通过发送特定的请求（如HTTP请求、Ping请求等）来确认服务器是否正常运行。
响应评估：根据服务器的响应判断其健康状态。如果响应时间过长或不响应，则判定该服务器可能存在问题。
状态更新：将检查结果反馈给负载均衡器，更新服务器的健康状态信息。