http.host contains rongzi.com


如何捕获报文
• 点击捕获->选项，打开捕获窗口   capture
  • 网卡设备/流量/捕获过滤器，点击“开始”按钮开始抓包   指定捕获的条件，减少网络包数据  选择多个网卡设备 command+点击
  • 输出（指定缓存文件）/选项（显示、名称解析、自动停止抓包条件） 面板
 • 点击捕获->停止，停止抓包
 
 
 捕获过滤器使用 bpfs语法  后面介绍     开始时指定
 接口 手机连接本地热点，捕获本地连接
     Microsoft: wlan 对外网络
     loopback : 本地环回地址 127.0.0.1
     
 输出   输出文件，格式，自动创建文件
 选项   自动停止捕获   实时刷新报文列表   解析Mac地址    
 
 
 
 wireshark  面板
  工具栏
  显示过滤器   分析时过滤数据     与捕获过滤器不一样
  数据包列表   通过颜色区分协议，虚线，实线
  数据包细节   网络分层对应的数据  
  数据包字节流  字节流与对应解码后的数据
  
 
 快捷方式工具栏   见图 快捷方式工具栏
 • 开始抓包（捕获->开始）
 • 停止抓包（捕获->停止）
 • 重新开始抓包（捕获->重新开始）
 • 打开选项面板抓包（捕获->选项）
 • 查找报文（编辑->查找分组）
 • 到前一报文（跳转->前一分组）
 • 到后一报文（跳转->后一分组）
 • 到指定报文（跳转->转至分组）
 • 到第一个报文（跳转->首个分组）
 • 到最后一个报文（跳转->最新分组）
 • 实时抓包时自动滚动窗口至最新报文  要不要一直最新的报文
 • 打开抓包文件（文件->打开）
 • 另存为文件（文件->另存为）
 • 关闭当前抓包（文件->关闭）
 • 重新载入抓包文件（视图->重新加载）
 • 对报文着色（视图->着色分组列表）
 • 放大（视图->缩放->放大）
 • 缩小（视图->缩放->缩小）
 • 恢复正常尺寸（视图->缩放->普通大小）
 • 使列宽适配内容长度（视图->调整列宽） 
 
 
 
 数据包的颜色（视图->着色规则） 可配颜色的   可增加自定义协议   对websocket.fin着色
 
 
 设定时间显示格式   默认是抓包的相对时间   
   修改时间格式    视图-》时间显示格式
   设定基于某一个数据包的相对时间  请求-》右键-》设为时间参考 
 
 
 数据包列表面板的标记符号  左侧的符号标记 
   选取有会话概念的请求时，会话的范围就标记出来了
   不属于本次会话的使用虚线标记  3次握手，查看port 是否属于同一个会话
   http请求 箭头向右    响应箭头向左
   选中的报文与此报文有某种关联  本次登录请求与下一次登录请求
   若当前选中的是 ACK 报文，则此报文是它确认的那个报文 与tcp的报文，ack确认报文收到  确认的是对前面发送的报文，会打钩
     http 请求  后面一个ack报文  ack确认http收到了，打钩的是http
   若当前选中的是 ACK 报文，则此报文是它重复确认的那个报文 存在丢包，重发的报文收到  忙碌的网络环境容易看见
   
   
 四种流跟踪  右键-》追踪流 == 显示过滤器 tcp.stream eq 1    右键后，显示过滤器自动存在
 • TCP
 • UDP
 • SSL
 • HTTP  
 
 
 
 文件操作  后端，需要分析多个服务器报文  对报文操作，减少分析难度
 • 标记报文 Ctrl+M   command+m
 • 导出标记报文（文件->导出特定分组->marked packet），亦可按过滤器导出报文   只会导出标记的报文   exported specified packets
   导出选中seleted packet 是当前选中的 一般是1个，后面可以查看数量
 • 合并读入多个报文（文件->合并）  合并报文的情况
 
 
如何快速抓取移动设备的报文？   也可以通过蓝牙
1. 在操作系统上打开 wifi 热点
2. 手机连接 wifi 热点
3. 用 Wireshark 打开捕获->选项面板，选择 wifi 热点对应的接口设备抓 包 



老兵
服务器上wireshark如何用？这样的的抓包工具有界面无法再服务器上运行吧？
作者回复: 一般先用tcpdump抓包，用-w把报文保存为文件，再找有GUI界面的机器，用wireshark打开文件分析


李雷
开了ss代理后，使用wireshark如何抓包？浏览器发送的请求在wireshark上看不到
作者回复: 51课有介绍，通过Chrome浏览器提供的密钥日志可以很方便的实现。https://time.geekbang.org/course/detail/175-104932


面向对象
能不能讲一下怎么抓手机端的http https 报文
作者回复: PC上开个wifi热点，手机连热点，再用wireshark抓包，注意选择正确的interface。
这里抓http报文没问题，但https报文是看不到TLS解密后的明文，因为此时你相当于中间人，而TLS是防中间人攻击的。如果是基于RSA协商密钥，可以把服务器私钥取出来设置到wireshark上解密。



对于 没有热点的操作系统，wireshark 可以通过数据连接线抓去手机端的报文吗？
作者回复: 可以




wireshark    https://zhuanlan.zhihu.com/p/267640786
协议分析（Protocol Analysis）（也称呼为网络分析-Network Analysis）是进入网络通信系统，捕获穿行在网络中的数据，
搜集网络统计信息，将数据包解码为可阅读形式的过程

