http/2.0主要对http/1.0做了大量性能的改进

HTTP/1.1 发明以来发生了哪些变化？
 • 从几 KB 大小的消息，到几 MB 大小的消息
 • 每个页面小于 10 个资源，到每页面 100 多个资源
 • 从文本为主的内容，到富媒体（如图片、声音、视频）为主的内容
 • 对页面内容实时性高要求的应用越来越多    视频直播，聊天
 
打开 www.sina.com.cn
 Chrome可以看到 400 requests    13MB resources
 
 
 
HTTP/1.1 的高延迟问题     http/1.1的最大问题
• 高延迟带来页面加载速度的降低
  • 随着带宽的增加，延迟并没有显著下降    家庭的带宽增加（10M），延迟降到一定程度不降了
      除了距离以外，还有最后一公里问题，路由器，交换机，消息排队的消耗
      延迟不下降，页面的加载速度降不下来
  • 并发连接有限    例如Chrome只能同时打开6个链接
  • 同一连接同时只能在完成一个 HTTP 事务（请求/响应）才能处理下一个事务
    request发出后，response没有返回是不能发送另一个请求的



为什么限制并发连接的数量
1.每次建立连接都需要额外的RTT，过多的连接并不能显著提升性能
2.长连接存在缺点，长连接需要消耗双方资源，尤其是服务器
https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Connection_management_in_HTTP_1.x
长连接也还是有缺点的；就算是在空闲状态，它还是会消耗服务器资源，而且在重负载时，还有可能遭受 DoS attacks 攻击。这种场景下，
可以使用非长连接，即尽快关闭那些空闲的连接，也能对性能有所提升
    
    
解决方案1
高延迟 VS 高带宽
• 单连接上的串行请求   http/1的现状
• 无状态导致的高传输量（低网络效率）    

长肥网络  带宽很大，允许大量飞行中的报文，同时时延RTT非常高
  理想的长肥是源源不断的发，源源不断的收   http1做不到的这种
  
  
无状态特性带来的巨大 HTTP 头部    REST架构的无状态，特别是cookie,cookie一般很大
 • 重复传输的体积巨大的 HTTP 头部
 不同浏览器的 http头部 
 
 


HTTP/1.1 为了解决性能问题做过的努力
• Spriting 合并多张小图为一张大图供浏览器 JS 切割使用   减少请求数
  • 不能区别对待    一张小图改了，需要重新生成一张大图，还是浪费大量带宽
• Inlining 内联，将图片嵌入到 CSS 或者 HTML 文件中，减少网络请求次数    图片base64编码
• Concatenation 拼接，将多个体积较小的 JavaScript 使用 webpack 等工具打包成 1 个体积更大的 JavaScript 文件
  • 1 个文件的改动导致用户重新下载多个文件
• Sharding 分片，将同一页面的资源分散到不同域名下，提升连接上限 
  浏览器对同一域名的连接是有限的
  

HTTP/1.1 不支持服务器推送消息  这个是没办法解决的    只能通过轮询的方式




Tommy🍭
老师，单链接上串行阻塞后会影响下一个请求这个怎么理解？是指的同一个CGI请求两次，第一次没有返回的情况下第二次请求需要保持等待吗？
作者回复: 是的，如果是在一个TCP连接上（chrome上最多只能并发6个连接）发2个请求，第1个请求没处理完时，没法发第2个请求，因为TCP是字符流，不能打乱顺序


吃饭饭
一直在听说比较 HTTP1.1 和 HTTP2 的区别，感觉 HTTP2 的确有很大的优势，为什么业界用 2.0 的感觉几乎没有？
作者回复: 现在很多网站都是支持http2协议的
  
 