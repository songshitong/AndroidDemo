IP  Internet Protocol   网际协议

网络层功能
• IP 寻址    确定目标主机在哪个网络中
• 选路        到达目标主机的路径有很多，需要选择最快速的那个
• 封装打包    当传输层把封装好的报文给网络层后，需要在报文首部添加IP头部，通过IP头部使得网络层可以正常工作
• 分片       如果传输层给的报文过大，需要网络层根据MTU进行分片
 层次越往下，抽象越低，越需要与硬件打交道
   应用层，表示层  http tls websocket 主要打交道的是web容器，中间件
   传输层  tcp/udp 操作系统的内核
   网络   如何把本地连接起来，组成Internet网络，并不关心本地硬件和各个子协议的用法
网络层是面向比特码，一位一位的发送，接收
   基于比特流的协议UART



数据链路层功能
• 逻辑链路控制     看起来没有连接，存在虚拟的连接
• 媒体访问控制     需要和网卡，电缆打交道，需要访问媒体    media access control->mac
• 封装链路层帧     从传输层接受的是字节流，但是发送的是比特位，需要将报文封装为链路层的帧，使得一条链路并发许多数据帧
• MAC 寻址        网络层基于IP寻址，链路层基于Mac地址寻址
• 差错检测与处理    为了防止出现错误
• 定义物理层标准    由于需要与物理层打交道，需要定义物理层标准



细腰结构：IP 网络层的核心地位   处于核心地位所以强调性能
• 性能至上的 IP 层
  • 无连接  管理连接，维护连接的成本太高了
  • 非可靠  没有使用ack确认包
  • 无确认
ip之上有许多协议，IP层之下，由于各种本地网络的存在，IP层之下的网络层和数据链路层也有许多协议，细腰结构
  icmp,arp协议都是来辅助IP协议的


多播：广播与组播   之前的client-server都是单播
  • 全球作用域    最大的，作用域越大风险越大
  • 组织内
  • 场点内        与网络结构有关，IPv6中定义的
  • 本地链路层    最常使用的广播方式
  • 本机作用域    最小的作用域，只有本机的进程能够收到


https://juejin.cn/post/6844904155102838791
虚拟互联网络
1）、实际的计算机网络是错综复杂的。
2）、物理设备通过使用 IP 协议，屏蔽了物理网络之间的差异。
3）、当网络中的主机使用 IP 协议连接时，则无需关注网络细节。
计算机 A 与 B 之间的数据通信可以认为是通过一个虚拟的互连网络进行传输的。
IP 协议的作用
 1）、IP 协议 使得复杂的实际网络变为一个虚拟互连的网络。
 2）、IP 协议 使得网络层可以屏蔽底层细节而专注网络层的数据转发。
 3）、IP 协议 解决了在虚拟网络中数据报传输路径的问题



路由器与交换机   不要关注IP地址时，工作中数据链路层
  • 工作在网络层的路由器       路由器，用来帮助跨越不同网络，工作在网络层
     • 连接不同网络的设备
  • 工作在数据链路层的交换机    只要交换机就可以让本地机器工作在一起，工作在数据链路层  通过mac地址定位
     • 同一个网络下连接不同主机的设备


网络传输示例
  主机 client向server发送数据
   通过本机的默认网关找到10.2.14.1  路由器
   进入bgp骨干网   bgp选择多条路径中最短的一条
   到达21.44.191.36所在的内网

BGP（Border Gateway Protocol，边界网关协议）



kakashi
并不是所有IP层的协议是无连接的，没记错的话，BGP是使用TCP的。
作者回复: 有些协议是跨层的，比如ARP就跨了二层与三层


ray
老师好，
您在课堂上提到封包在传输时，会先透过IP位址寻找到要将封包传递给哪个网域，之后再透过交换机及MAC address找到相对应的机器。

这里我有个疑问，数据链路层不是在IP层之下吗？按照这个传输逻辑来看，link layer似乎被实作在IP层之上，因为我们必需先找到IP address，才能利用MAC辨识出要传给该IP address下的哪一台机器。

如果我理解没有错，为什么在实务上，TCP/IP这套通讯模型，会把link layer以上述的方式实作，打破了原先我们所理解的OSI模型？

谢谢老师的解答^^
作者回复: 选路的逻辑，与主机上接收报文的处理是不同的。当主机发送报文时，必须先选路，而选路的逻辑天然自上而下，而不是先进入细节。



我在你的视线里
上三层主要是应用层，打交道的是容器和中间件。传输层打交道的是内核。网络层负责路由和报文的转发。什么是容器？什么是中间件?作用是什么呢？
作者回复: 容器是web服务器中的概念，它封装了http协议解析、线程管理、网络资源等接口，使业务开发不涉及底层细节。
中间件是不同层级软件间的连接组件，它是从另一个角度阐明概念，常用于连接底层与业务层。


吃饭饭
七层网络模型的网络层只有一个协议：IP 层，所以网络层也叫 IP 层？可以这么理解吧老师
作者回复: 可以。当然IP层还有一些辅助IP协议的其他协议，例如ICMP协议