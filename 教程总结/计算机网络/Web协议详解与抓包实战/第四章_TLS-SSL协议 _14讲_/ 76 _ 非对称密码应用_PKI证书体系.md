PKI 公钥基础设施

非对称密码应用：数字签名
• 基于私钥加密，只能使用公钥解密：起到身份认证的使用    公钥大家都有，大家知道这个消息是我发出的
• 公钥的管理：Public Key Infrastructure（PKI）公钥基础设施
  • 由 Certificate Authority（CA）数字证书认证机构将用户个人身份与公开密钥关联在一起
  • 公钥数字证书组成
     • CA 信息、公钥用户信息、公钥、权威机构的签字、有效期
   • PKI 用户
     • 向 CA 注册公钥的用户    网站站长
     • 希望使用已注册公钥的用户   浏览器


签发证书流程
  鲍勃有个网站
  认证机构使用自己的私钥进行加密

签名与验签流程



证书信任链
  根CA机构
  权威CA机构

  自己的信任由上一层机构进行背书


PKI 公钥基础设施
   证书订阅人  鲍勃
   证书是有有效期
   CRL服务器性能差，可以用OCSP程序


证书类型  三类    加密效果的等价的，对身份的验证不同
 域名验证    免费的
 组织验证    昂贵
 扩展验证    金融机构


验证证书链  TLS层的握手可看到CA机构和服务器公钥
   浏览器地址栏，小锁，点击可看到证书详情  过期时间，公钥，证书颁发者信息







magicnum
如果CA证书链有10层，难道要发10次TLS握手来拿到网站以及各个CA的证书，从而进行验证？这样第一次访问是不是也太慢了
作者回复: 1、一条Server Hello消息会发多个证书。
2、只有3层，根证书和权威证书


爱因诗贤
我想问一个问题哈，一般来说要向谁发送消息就需要使用这个人的 公钥加密，然后这个人收到消息之后就能用自己的私钥解密了，
  但是数字签名的时候是用 私钥加密的，接收信息的人是通过公钥解密对比签名的，公钥和私钥的关系是对等的么
作者回复: 功能不同：
用公钥加密是为了保密性，然而，这并没有身份认证作用；
反之，用私钥签名没有保密性，但可用于身份认证。


爱因诗贤
我有个疑问，根据上一小节得知，私钥可以推出公钥，签名的时候私钥加密，公钥解密是如何做到的呢？
作者回复: 可以再看一下74课4分39秒RSA的解密过程，其中私钥是187，而公钥是3


wjy
老师，数字证书里不是含有效期信息吗？为什么还需要CRL服务器。另外有效期查询是每次客户端访问都需要的操作吗？
作者回复: 证书还可能提前吊销，此时公钥证书本身仍然有效，只能通过CRL链来解决了。
   不是每次，与每个客户端具体的实现有关的。


tongmin_tsai
老师，按照本课程里面的流程，有些概念有混淆，望解答，BOB先生成了自己的公司要BPUB和BPRI，然后去CA机构注册，
注册中用到了BOB的信息以及BPUB，然后CA机构返回了CA证书，CA证书包含了版本签名算法，签名哈希算法、公钥等信息，那么在签名和验签流程PPT中，
数据的加解密都用到的是CA里面的公私钥吗？那段把HASH值加密，用的是BOB生成的BPRI还是CA机构的私钥，如果是CA机构的私钥，能获取到吗？
如果都是用BOB的公钥和私钥，那么CA机构在这个过程中，起到什么作用呢？
作者回复: 1、数据加解密用的是Bob的公私钥，这样只有Bob能解密；
2、浏览器拿到的证书是从网络上获取到的。确认证书里的Bob确实是Bob而不是Charlie，需要依赖CA机构用其私钥加密的摘要，
因为浏览器可以根据根证书知道CA机构是可信的，它拿到了CA机构的公钥，又通过解密摘要知道这段证书是CA认可的。


LEON
请教老师，比如我在家去访问您的taohui pub网站。如果我的浏览器里面没有根证书对您的网站的证书或者证书链信任。浏览器有没有功能到互联网进行下载对您信任的CA证书？遇到这种问题一般如何解决？
作者回复: 没有办法，浏览器会提示这个网站不值得信任。你可以openssl生成一个自签名的证书，配置到网站上体验下。

子杨
陶老师，验签的过程，浏览器是如何把用户的身份信息给提取出来然后计算哈希值的？不是已经加密过了吗？
作者回复: 这些信息是用CA私钥加密的，所以用CA公钥可以解密，而CA公钥是公开的

杨
陶老师这里还是有点糊涂，证书的作用只是用来做身份认证的吧？那么证书里面网站的公钥是干啥用的？
作者回复: 网站把公钥给浏览器，这样浏览器用公钥加密信息，只有拥有私钥的网站才能解密

子杨
陶老师，其实我想问的是，后面不是通过 ECDH 算法来实现非对称加密交换对称加密的秘钥，然后进行对称加密的通信的吗？那么证书里的网站公钥是在什么时候加密用的？
作者回复: 浏览器验证服务器签名使用
